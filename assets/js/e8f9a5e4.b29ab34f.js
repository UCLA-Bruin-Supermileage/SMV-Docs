"use strict";(self.webpackChunksmv_docs=self.webpackChunksmv_docs||[]).push([[7714],{5637:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>a,default:()=>l,frontMatter:()=>i,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"server/part-2-pfSense-n-stuff","title":"pfSense and Networking","description":"This page will go over how our router/firewall is configured along with the network provisions that we applied to from SEASnet.","source":"@site/docs/server/part-2-pfSense-n-stuff.md","sourceDirName":"server","slug":"/server/part-2-pfSense-n-stuff","permalink":"/docs/server/part-2-pfSense-n-stuff","draft":false,"unlisted":false,"editUrl":"https://github.com/Howard-Z/SMV-Docs/blob/main/docs/server/part-2-pfSense-n-stuff.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"The Hardware","permalink":"/docs/server/part-1-the-server"},"next":{"title":"Unraid, Docker, and VMs","permalink":"/docs/server/part-3-Unraid-n-stuff"}}');var o=n(4848),s=n(8453);const i={sidebar_position:2},a="pfSense and Networking",d={},h=[{value:"Obtaining the IP",id:"obtaining-the-ip",level:2},{value:"Activating the Physical Network Port",id:"activating-the-physical-network-port",level:2},{value:"Port Forwarding",id:"port-forwarding",level:2},{value:"Ports Open to the Internet",id:"ports-open-to-the-internet",level:3},{value:"Reverse Proxy with NGINX Proxy Manager",id:"reverse-proxy-with-nginx-proxy-manager",level:4},{value:"Ports Open to the VPN",id:"ports-open-to-the-vpn",level:3}];function c(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"pfsense-and-networking",children:"pfSense and Networking"})}),"\n",(0,o.jsx)(t.p,{children:"This page will go over how our router/firewall is configured along with the network provisions that we applied to from SEASnet."}),"\n",(0,o.jsx)(t.h2,{id:"obtaining-the-ip",children:"Obtaining the IP"}),"\n",(0,o.jsxs)(t.p,{children:['In order to obtain our domain name from UCLA, we filled out the "',(0,o.jsx)(t.a,{href:"https://www.seasnet.ucla.edu/ip-request/",children:"IP Address Request form"}),'". Our adviser is ',(0,o.jsx)(t.a,{href:"https://www.seasbldgsrv.ucla.edu/staff/",children:"Anthony Redon"})," and we contact him to authorize any and all of our requests between us and UCLA IT."]}),"\n",(0,o.jsx)(t.h2,{id:"activating-the-physical-network-port",children:"Activating the Physical Network Port"}),"\n",(0,o.jsxs)(t.p,{children:["In order for the port in the shop to provide us with an internet connection we have to have a valid ",(0,o.jsx)(t.strong,{children:"static"})," IP configuration provided to us by UCLA IT. This can be applied for ",(0,o.jsx)(t.a,{href:"https://www.seasnet.ucla.edu/seasnet-service-request/",children:"here"}),". Again, we needed to contact Anthony to make this happen."]}),"\n",(0,o.jsx)(t.h2,{id:"port-forwarding",children:"Port Forwarding"}),"\n",(0,o.jsxs)(t.p,{children:["By default, we get an internet connection that is behind a NAT table with no ports forwarded. This means that we have internet connectivity but no ability to host any services that people can connect to. In order to have ports forwarded to through the school firewall, we have to fill out another ",(0,o.jsx)(t.a,{href:"https://www.seasnet.ucla.edu/firewall-access-request/",children:"form"})," yet again. Again, our adviser is Anthony Redon."]}),"\n",(0,o.jsx)(t.p,{children:"We have 2 types of port forwards that we use. The first is the normal port forward that makes the port visible to the world wide web. The second is a port forward that makes the port visible to ONLY the UCLA VPN. By UCLA VPN I mean the Cisco VPN. Even though we have our own firewall provided by pfSense the school layers a firewall on top of ours that truly controls our network."}),"\n",(0,o.jsx)(t.h3,{id:"ports-open-to-the-internet",children:"Ports Open to the Internet"}),"\n",(0,o.jsx)(t.p,{children:"We only have 3 ports that are open to the internet. They are:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"80:     http\n443:    https\n1883    MQTT\n"})}),"\n",(0,o.jsxs)(t.p,{children:["Port 443 and 80 are for our websites. They point to our Nginx reverse proxy manager that handles traffic between our VMs for the documentation server and the main website. Traffic to the URL ",(0,o.jsx)(t.code,{children:"smv.seas.ucla.edu"})," will be forwarded to the frontend Docker container and traffic to ",(0,o.jsx)(t.code,{children:"prod-django.bruinsmv.com"})," will be sent to the API."]}),"\n",(0,o.jsxs)(t.p,{children:["The subdomain ",(0,o.jsx)(t.code,{children:"info.bruinsmv.com"})," is hosted on GitHub pages with a custom domain."]}),"\n",(0,o.jsx)(t.h4,{id:"reverse-proxy-with-nginx-proxy-manager",children:"Reverse Proxy with NGINX Proxy Manager"}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Figure 1",src:n(7992).A+"",width:"515",height:"279"})}),"\n",(0,o.jsx)(t.p,{children:"NGINX Proxy Manager routes traffic based on domain:"}),"\n",(0,o.jsxs)(t.table,{children:[(0,o.jsx)(t.thead,{children:(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.th,{children:"Domain"}),(0,o.jsx)(t.th,{children:"Internal Service"})]})}),(0,o.jsxs)(t.tbody,{children:[(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:(0,o.jsx)(t.code,{children:"prod-django.bruinsmv.com"})}),(0,o.jsxs)(t.td,{children:[(0,o.jsx)(t.code,{children:"192.168.69.14"})," (API)"]})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:(0,o.jsx)(t.code,{children:"smv.seas.ucla.edu"})}),(0,o.jsxs)(t.td,{children:[(0,o.jsx)(t.code,{children:"192.168.69.13"})," (Frontend)"]})]})]})]}),"\n",(0,o.jsx)(t.h3,{id:"ports-open-to-the-vpn",children:"Ports Open to the VPN"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"21:     FTP\n22:     SSH\n3283:   Apple Remote Desktop **\n3389:   Windows RDP\n5432:   PostgreSQL\n6379:   Redis\n8008:   Not in Use **\n8080:   Unraid Web UI\n8081:   pfSense *\n8443:   Not in Use **\n25565:  Minecraft\n"})}),"\n",(0,o.jsx)(t.p,{children:"* The pfSense Web GUI is not accessible from WAN or VPN, it can only be accessed on the LAN side or using any of our alternative VPN solutions (tailscale)."}),"\n",(0,o.jsx)(t.p,{children:"** The firewall request was never confirmed, but it seems that it works? Testing required if you're going to use them."}),"\n",(0,o.jsxs)(t.p,{children:["As of time of writing (May 26, 2025) this is what the NAT Table (port forwarding) rules look like for our pfSense node.\n",(0,o.jsx)(t.img,{alt:"Figure 1",src:n(1677).A+"",width:"1422",height:"466"})]})]})}function l(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},7992:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/smv-network-2-c36da0d7aa3d4b1c99e27ebd7f75c9cf.png"},1677:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/nat-tables-e6318bd8ee7c860341710b75cfc8fffb.png"},8453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>a});var r=n(6540);const o={},s=r.createContext(o);function i(e){const t=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(s.Provider,{value:t},e.children)}}}]);