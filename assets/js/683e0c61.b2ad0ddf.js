"use strict";(self.webpackChunksmv_docs=self.webpackChunksmv_docs||[]).push([[9693],{1683:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"server/part-4-cicd","title":"CI/CD Pipeline Documentation","description":"This repository uses GitHub Actions to automate the build and deployment process for two key services: SMV-API and SMV-Website. Both services are containerized using Docker and hosted on GitHub Container Registry (GHCR).","source":"@site/docs/server/part-4-cicd.md","sourceDirName":"server","slug":"/server/part-4-cicd","permalink":"/docs/server/part-4-cicd","draft":false,"unlisted":false,"editUrl":"https://github.com/Howard-Z/SMV-Docs/blob/main/docs/server/part-4-cicd.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Unraid, Docker, and VMs","permalink":"/docs/server/part-3-Unraid-n-stuff"},"next":{"title":"SMV-API Development Guide","permalink":"/docs/server/part-5-dev"}}');var r=i(4848),t=i(8453);const o={sidebar_position:4},c="CI/CD Pipeline Documentation",l={},a=[{value:"Overview",id:"overview",level:2},{value:"SMV-API",id:"smv-api",level:2},{value:"Requirements",id:"requirements",level:3},{value:"SMV-Website",id:"smv-website",level:2},{value:"Requirements",id:"requirements-1",level:3},{value:"Monitoring GitHub Actions",id:"monitoring-github-actions",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"cicd-pipeline-documentation",children:"CI/CD Pipeline Documentation"})}),"\n",(0,r.jsxs)(n.p,{children:["This repository uses GitHub Actions to automate the build and deployment process for two key services: ",(0,r.jsx)(n.code,{children:"SMV-API"})," and ",(0,r.jsx)(n.code,{children:"SMV-Website"}),". Both services are containerized using Docker and hosted on ",(0,r.jsx)(n.a,{href:"https://ghcr.io/",children:"GitHub Container Registry (GHCR)"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:["There are two workflow files under ",(0,r.jsx)(n.code,{children:".github/workflows"})," in each repository:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Pull Request Workflow"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Trigger"}),": Activated when a pull request is made to the ",(0,r.jsx)(n.code,{children:"master"})," branch."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Builds the Docker image to verify that the code compiles and runs correctly (sanity check)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Merge to Master Workflow"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Trigger"}),": Activated when a pull request is merged into ",(0,r.jsx)(n.code,{children:"master"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Builds and deploys the Docker image to:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"ghcr.io/ucla-bruin-supermileage/smv-api:latest"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"ghcr.io/ucla-bruin-supermileage/smv-website:latest"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"These images can be pulled using Docker from any compatible system."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"smv-api",children:"SMV-API"}),"\n",(0,r.jsx)(n.h3,{id:"requirements",children:"Requirements"}),"\n",(0,r.jsx)(n.p,{children:"To run the SMV-API container successfully, the following environment variables must be set:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"DJANGO_SECRET_KEY"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"POSTGRES_PW"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"MQTT_PW"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"These values should be set:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["In the virtual machine (VM) you are using",(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.strong,{children:"or"})]}),"\n",(0,r.jsxs)(n.li,{children:["As environment variables when creating the Docker container in ",(0,r.jsx)(n.strong,{children:"UnRAID"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Additionally, in UnRAID, the following variable must be added to the container configuration to enable automatic updates via Watchtower:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-env",children:"com.centurylinklabs.watchtower.enable=true\n"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Note"}),': The values for the required environment variables can be found on the Notion "Logins" page. Please contact a lead if you do not have access.']}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"smv-website",children:"SMV-Website"}),"\n",(0,r.jsx)(n.h3,{id:"requirements-1",children:"Requirements"}),"\n",(0,r.jsx)(n.p,{children:"The SMV-Website container does not require any environment variables to function. However, to enable Watchtower automatic updates in UnRAID, the following variable must be set:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-env",children:"com.centurylinklabs.watchtower.enable=true\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"monitoring-github-actions",children:"Monitoring GitHub Actions"}),"\n",(0,r.jsxs)(n.p,{children:["GitHub Actions are triggered automatically based on the event (PR or merge to ",(0,r.jsx)(n.code,{children:"master"}),"). You can view the status and logs of each workflow run in the ",(0,r.jsx)(n.strong,{children:"Actions"})," tab of the respective repositories:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/ucla-bruin-supermileage/smv-api/actions",children:"SMV-API Actions"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/ucla-bruin-supermileage/smv-website/actions",children:"SMV-Website Actions"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>c});var s=i(6540);const r={},t=s.createContext(r);function o(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);